"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const c=require("fs"),d=require("path"),T=require("glob/sync.js"),y=e=>e&&typeof e=="object"&&"default"in e?e:{default:e};function w(e){if(e&&e.__esModule)return e;const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const r in e)if(r!=="default"){const n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:()=>e[r]})}}return t.default=e,Object.freeze(t)}const p=y(d),m=y(T);function k(){return()=>{}}function b(e){return e}function S(){}function v(e){if(Array.isArray(e))return function(n){return n.map(i=>v(i))}(e);e=function(n={}){return function(i=k,o=b,s=S,j={}){n.src=i,n.proc=o,n.sink=s,n.meta=j}(n.src,n.proc,n.sink,n.meta),n}(e);let t=e.src,r=e.proc(t,e.meta);return e.sink(r,e.meta)}function f(e,t){return r=>e(r,t)}function l(e){return typeof e=="object"?d.format(e):e}const A="./src/task/*.js";let a;const u={},g=e=>u[e.id]=e;function P(e){const t={id:p.default.basename(a||"",p.default.extname(a||"")),url:a,...e};g(t)}function h(){process.listenerCount("task")==0&&process.on("task",P)}exports.bypass=b,exports.clean=function e(t,r){return Array.isArray(t)?void t.forEach(n=>e(n)):(t=l(t),m.default(t).forEach(n=>{c.rmSync(n,{recursive:!0,force:!0,...r==null?void 0:r.options})}),t)},exports.dummySink=S,exports.dummySrc=k,exports.hasTask=e=>u[e]!==void 0,exports.initApi=()=>process.env.VESIC_API=!0,exports.listenTask=h,exports.loadTasks=async function(e=A){h();const t=await m.default(e,{});for(let r of t)a=r,await Promise.resolve().then(()=>w(require(p.default.resolve(r))))},exports.meta=f,exports.parallel=function(...e){return(t,r)=>e.map(n=>n(t,r))},exports.print=function(e){console.log(e)},exports.readFile=function(e,t){return e=l(e||(t==null?void 0:t.path)),c.readFileSync(e,(t==null?void 0:t.options)||"utf-8")},exports.registerTask=g,exports.runTask=function(e){const t=Date.now();u[e].main();const r=Date.now();return{start:t,stop:r,dur:r-t}},exports.series=function(...e){return(t,r)=>e.reduce((n,i)=>i(n,r),t)},exports.stream=function(e,t,r){let n,i;return{src(o){return e=o,this},done:()=>r,meta(o){return t=o,this},useProc(o){return n=o,this},proc(o,s){return s&&this.meta(s),typeof o=="object"&&(o=f(n,o)),e=o(e,t||{}),this},useSink(o){return i=o,this},sink(o,s){return s&&this.meta(s),typeof o=="object"&&(o=f(i,o)),r=o(e,t||{}),this},series(...o){return o.forEach(s=>this.proc(s)),this},parallel(...o){return o.forEach(s=>this.sink(s)),this}}},exports.task=function(e){process.env.VESIC_API==="true"?process.emit("task",e):e.main()},exports.tasks=u,exports.unregisterTask=e=>u[e]=void 0,exports.vesic=v,exports.writeFile=function(e,t){let r=l(t==null?void 0:t.path);const n=d.dirname(r);return c.mkdirSync(n,{recursive:!0}),c.writeFileSync(r,e.toString(),t==null?void 0:t.options),e};
